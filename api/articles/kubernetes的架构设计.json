{"title":"kubernetes的架构设计","uid":"64e1a25088b85c68e2e16be94c5eff1a","slug":"kubernetes的架构设计","date":"2023-04-14T14:32:15.000Z","updated":"2023-04-14T06:32:15.000Z","comments":true,"path":"api/articles/kubernetes的架构设计.json","keywords":null,"cover":null,"content":"<h4 id=\"Master节点：Master节点是K8s集群的控制节点，在生产环境中不建议部署集群核心组件以外的任何容器，公司业务的容器更是不要部署到master节点上，以免升级或者维护时对业务造成影响：\"><a href=\"#Master节点：Master节点是K8s集群的控制节点，在生产环境中不建议部署集群核心组件以外的任何容器，公司业务的容器更是不要部署到master节点上，以免升级或者维护时对业务造成影响：\" class=\"headerlink\" title=\"Master节点：Master节点是K8s集群的控制节点，在生产环境中不建议部署集群核心组件以外的任何容器，公司业务的容器更是不要部署到master节点上，以免升级或者维护时对业务造成影响：\"></a>Master节点：Master节点是K8s集群的控制节点，在生产环境中不建议部署集群核心组件以外的任何容器，公司业务的容器更是不要部署到master节点上，以免升级或者维护时对业务造成影响：</h4><ul>\n<li><strong>kube-apiserver：整个集群的控制中枢</strong><ul>\n<li><strong>提供集群中各个模块之间的数据交换，并将集群状态和信息存储到分布式键值对（key-value）存储到etcd集群中。</strong></li>\n<li><strong>集群管理，资源配额，集群安全机制的入口，为集群各类资源对象提供增删改查以及watch的REST API接口</strong></li>\n</ul>\n</li>\n<li><strong>kube-controller-manager ：集群状态管理器</strong><ul>\n<li><strong>保证Pod或其他资源达到期望值，当Pod的副本数或者其他资源因故障和错误导致无法正常运行，没有达到设定的值时，Controller-manager会尝试自动修复达到期望值</strong></li>\n<li><strong>Controller-manager包含 Node controller ，ReplicationController，EndpointController，NamespaceController，ServiceAccountController，RescueQuotaController，ServiceController和TokenController等</strong></li>\n</ul>\n</li>\n<li><strong>kube-scheduler：集群pod的调度中心</strong><ul>\n<li><strong>通过调度算法将pod分配最佳node节点上，它通过APIServer监听所有pod的状态</strong></li>\n<li><strong>如果有pod未被调度到任何一个node节点上面，那么Scheduler会通过策略选择最佳node节点进行调度，对每一个Pod创建一个绑定 然后被调度的节点上的kubelet负责启动该pod</strong></li>\n<li><strong>Scheduler是集群可插拔组件，它跟踪每个节点上的资源利用率以确保工作负载不会超过可用资源。</strong></li>\n<li><strong>Scheduler在调度过程中需要考虑公平，资源高效利用，效率等方面的问题</strong></li>\n</ul>\n</li>\n<li><strong>etcd：数据存储组件</strong><ul>\n<li><strong>持久型，轻量型，分布式的键值（key-value）数据存储组件</strong></li>\n<li><strong>etcd高可用是k8s集群中至关重要的一环，在生产环境中建议部署大于3的奇数的etcd集群，来保障数据的安全性和可恢复性。</strong></li>\n<li><strong>大规模集群环境建议部署etcd集群在k8s集群外，使用高性能服务器部署提高etcd性能和延迟</strong></li>\n</ul>\n</li>\n</ul>\n<h4 id=\"noder节点：Node节点主要负责部署运行容器，确保每个节点上都有可运行的docker容器。Node节点包括以下组件：\"><a href=\"#noder节点：Node节点主要负责部署运行容器，确保每个节点上都有可运行的docker容器。Node节点包括以下组件：\" class=\"headerlink\" title=\"noder节点：Node节点主要负责部署运行容器，确保每个节点上都有可运行的docker容器。Node节点包括以下组件：\"></a>noder节点：Node节点主要负责部署运行容器，确保每个节点上都有可运行的docker容器。Node节点包括以下组件：</h4><ul>\n<li><strong>kubelet：</strong><ul>\n<li><strong>负责与Master节点通信协作，管理该节点上的Pod，对容器进行健康检查及监控，同时负责上报Pod的状态</strong></li>\n</ul>\n</li>\n<li><strong>kube-proxy：</strong><ul>\n<li><strong>负责Pod之间的通信和负载均衡，将指定流量发到后的正确的机器上</strong></li>\n</ul>\n</li>\n<li><strong>Docker Engine：</strong><ul>\n<li><strong>Docker引擎，负载对容器的管理</strong></li>\n</ul>\n</li>\n</ul>\n<h4 id=\"Calico：符合CNI标准的网络插件，负责给每个pod分配不重复的IP\"><a href=\"#Calico：符合CNI标准的网络插件，负责给每个pod分配不重复的IP\" class=\"headerlink\" title=\"Calico：符合CNI标准的网络插件，负责给每个pod分配不重复的IP\"></a>Calico：符合CNI标准的网络插件，负责给每个pod分配不重复的IP</h4><h4 id=\"Addons：Addons是Kubernetes提供的可选组件，用于扩展集群功能，包括：\"><a href=\"#Addons：Addons是Kubernetes提供的可选组件，用于扩展集群功能，包括：\" class=\"headerlink\" title=\"Addons：Addons是Kubernetes提供的可选组件，用于扩展集群功能，包括：\"></a>Addons：Addons是Kubernetes提供的可选组件，用于扩展集群功能，包括：</h4><ul>\n<li><strong>DNS：提供集群内部DNS服务；</strong></li>\n<li><strong>Dashboard：提供集群管理和监控功能；</strong></li>\n<li><strong>Ingress Controller：提供HTTP和HTTPS流量的路由和负载均衡服务；</strong></li>\n<li><strong>Metrics Server：收集集群中的度量指标。</strong></li>\n</ul>\n<p><strong>Kubernetes架构的设计旨在实现高可用性和可扩展性。Master节点使用高可用性的配置，包括多个实例和负载均衡器，以确保在Master节点出现故障时，集群仍然可以正常运行。Node节点可以根据需要添加或删除，以实现集群的水平扩展。</strong></p>\n<p><strong>总之，Kubernetes架构是一个分层的设计，旨在为容器化应用程序提供高可用性、可靠性和可扩展性。各个组件和角色之间相互协作，共同构建一个功能强大的容器编排平台。</strong></p>\n","feature":true,"text":"Master节点：Master节点是K8s集群的控制节点，在生产环境中不建议部署集群核心组件以外的任何容器，公司业务的容器更是不要部署到master节点上，以免升级或者维护时对业务造成影响： kube-apiserver：整个集群的控制中枢 提供集群中各个模块之间的数据交换，并将...","link":"","photos":[],"count_time":{"symbolsCount":"1.6k","symbolsTime":"1 mins."},"categories":[],"tags":[{"name":"Kubernetes","slug":"Kubernetes","count":2,"path":"api/tags/Kubernetes.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#Master%E8%8A%82%E7%82%B9%EF%BC%9AMaster%E8%8A%82%E7%82%B9%E6%98%AFK8s%E9%9B%86%E7%BE%A4%E7%9A%84%E6%8E%A7%E5%88%B6%E8%8A%82%E7%82%B9%EF%BC%8C%E5%9C%A8%E7%94%9F%E4%BA%A7%E7%8E%AF%E5%A2%83%E4%B8%AD%E4%B8%8D%E5%BB%BA%E8%AE%AE%E9%83%A8%E7%BD%B2%E9%9B%86%E7%BE%A4%E6%A0%B8%E5%BF%83%E7%BB%84%E4%BB%B6%E4%BB%A5%E5%A4%96%E7%9A%84%E4%BB%BB%E4%BD%95%E5%AE%B9%E5%99%A8%EF%BC%8C%E5%85%AC%E5%8F%B8%E4%B8%9A%E5%8A%A1%E7%9A%84%E5%AE%B9%E5%99%A8%E6%9B%B4%E6%98%AF%E4%B8%8D%E8%A6%81%E9%83%A8%E7%BD%B2%E5%88%B0master%E8%8A%82%E7%82%B9%E4%B8%8A%EF%BC%8C%E4%BB%A5%E5%85%8D%E5%8D%87%E7%BA%A7%E6%88%96%E8%80%85%E7%BB%B4%E6%8A%A4%E6%97%B6%E5%AF%B9%E4%B8%9A%E5%8A%A1%E9%80%A0%E6%88%90%E5%BD%B1%E5%93%8D%EF%BC%9A\"><span class=\"toc-text\">Master节点：Master节点是K8s集群的控制节点，在生产环境中不建议部署集群核心组件以外的任何容器，公司业务的容器更是不要部署到master节点上，以免升级或者维护时对业务造成影响：</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#noder%E8%8A%82%E7%82%B9%EF%BC%9ANode%E8%8A%82%E7%82%B9%E4%B8%BB%E8%A6%81%E8%B4%9F%E8%B4%A3%E9%83%A8%E7%BD%B2%E8%BF%90%E8%A1%8C%E5%AE%B9%E5%99%A8%EF%BC%8C%E7%A1%AE%E4%BF%9D%E6%AF%8F%E4%B8%AA%E8%8A%82%E7%82%B9%E4%B8%8A%E9%83%BD%E6%9C%89%E5%8F%AF%E8%BF%90%E8%A1%8C%E7%9A%84docker%E5%AE%B9%E5%99%A8%E3%80%82Node%E8%8A%82%E7%82%B9%E5%8C%85%E6%8B%AC%E4%BB%A5%E4%B8%8B%E7%BB%84%E4%BB%B6%EF%BC%9A\"><span class=\"toc-text\">noder节点：Node节点主要负责部署运行容器，确保每个节点上都有可运行的docker容器。Node节点包括以下组件：</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#Calico%EF%BC%9A%E7%AC%A6%E5%90%88CNI%E6%A0%87%E5%87%86%E7%9A%84%E7%BD%91%E7%BB%9C%E6%8F%92%E4%BB%B6%EF%BC%8C%E8%B4%9F%E8%B4%A3%E7%BB%99%E6%AF%8F%E4%B8%AApod%E5%88%86%E9%85%8D%E4%B8%8D%E9%87%8D%E5%A4%8D%E7%9A%84IP\"><span class=\"toc-text\">Calico：符合CNI标准的网络插件，负责给每个pod分配不重复的IP</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#Addons%EF%BC%9AAddons%E6%98%AFKubernetes%E6%8F%90%E4%BE%9B%E7%9A%84%E5%8F%AF%E9%80%89%E7%BB%84%E4%BB%B6%EF%BC%8C%E7%94%A8%E4%BA%8E%E6%89%A9%E5%B1%95%E9%9B%86%E7%BE%A4%E5%8A%9F%E8%83%BD%EF%BC%8C%E5%8C%85%E6%8B%AC%EF%BC%9A\"><span class=\"toc-text\">Addons：Addons是Kubernetes提供的可选组件，用于扩展集群功能，包括：</span></a></li></ol>","author":{"name":"xiaomaomi","slug":"blog-author","avatar":"https://www.991229.cn/i/2023/04/13/64376d0c494e1.png","link":"/","description":"学习devops的每一天","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{},"next_post":{"title":"高可用部署k8s集群（二进制）","uid":"d670df397553a310eb51aea95c3eefc2","slug":"高可用部署k8s集群（二进制）","date":"2023-04-14T14:28:03.000Z","updated":"2023-04-14T06:28:04.000Z","comments":true,"path":"api/articles/高可用部署k8s集群（二进制）.json","keywords":null,"cover":null,"text":"（一）环境准备集群节点介绍 IP地址 机器角色 集群组件 192.168.2.188 VIP HAProxy keepalived centos7.5 192.168.2.18 Master1 kube-apiserver kube-controller-manage kube-...","link":"","photos":[],"count_time":{"symbolsCount":"72k","symbolsTime":"1:06"},"categories":[],"tags":[{"name":"Kubernetes","slug":"Kubernetes","count":2,"path":"api/tags/Kubernetes.json"}],"author":{"name":"xiaomaomi","slug":"blog-author","avatar":"https://www.991229.cn/i/2023/04/13/64376d0c494e1.png","link":"/","description":"学习devops的每一天","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"feature":true}}